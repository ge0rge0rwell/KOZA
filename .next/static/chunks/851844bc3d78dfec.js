(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31278,e=>{"use strict";let t=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],31278)},49207,e=>{"use strict";var t=e.i(47167),a=e.i(43476),l=e.i(71645),s=e.i(75254);let r=(0,s.default)("heart",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]]),i=(0,s.default)("repeat-2",[["path",{d:"m2 9 3-3 3 3",key:"1ltn5i"}],["path",{d:"M13 18H7a2 2 0 0 1-2-2V6",key:"1r6tfw"}],["path",{d:"m22 15-3 3-3-3",key:"4rnwn2"}],["path",{d:"M11 6h6a2 2 0 0 1 2 2v10",key:"2f72bc"}]]),n=(0,s.default)("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]]),o=(0,s.default)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]),c=({post:e,onLike:t,onBoost:s,onReply:c})=>{var d;let x,[u,m]=(0,l.useState)(!1),[h,p]=(0,l.useState)(!1);return(0,a.jsxs)("article",{className:"bg-neutral-900 border border-neutral-800 rounded-2xl p-5 hover:border-neutral-700 transition-all duration-200 group",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("img",{src:e.author.avatarUrl,alt:e.author.displayName,className:"w-10 h-10 rounded-full object-cover ring-2 ring-neutral-800 group-hover:ring-primary-500/30 transition-all",onError:t=>t.target.src=`https://ui-avatars.com/api/?name=${e.author.username}&background=6d28d9&color=fff`}),(0,a.jsx)("div",{className:"absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-emerald-500 rounded-full border-2 border-neutral-900"})]}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-white truncate",children:e.author.displayName}),(0,a.jsxs)("p",{className:"text-xs text-neutral-500 truncate",children:["@",e.author.username]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-xs text-neutral-600",children:(d=e.createdAt,(x=(Date.now()-new Date(d).getTime())/1e3)<60?`${Math.floor(x)}s`:x<3600?`${Math.floor(x/60)}m`:x<86400?`${Math.floor(x/3600)}s`:new Date(d).toLocaleDateString("tr-TR"))}),(0,a.jsx)("a",{href:e.author.mastodonUrl,target:"_blank",rel:"noopener noreferrer",className:"text-neutral-700 hover:text-primary-400 transition-colors",children:(0,a.jsx)(o,{size:13})})]})]}),(0,a.jsx)("div",{className:"text-neutral-200 text-sm leading-relaxed mb-4 prose prose-invert prose-sm max-w-none",dangerouslySetInnerHTML:{__html:e.htmlContent}}),e.media?.length>0&&(0,a.jsx)("div",{className:`grid gap-2 mb-4 ${e.media.length>1?"grid-cols-2":"grid-cols-1"}`,children:e.media.map((e,t)=>"image"===e.type&&(0,a.jsx)("img",{src:e.url,alt:e.alt||"Media attachment",className:"w-full rounded-xl object-cover max-h-64"},t))}),(0,a.jsxs)("div",{className:"flex items-center gap-6 pt-3 border-t border-neutral-800/50",children:[(0,a.jsxs)("button",{onClick:()=>c?.(e.id),className:"flex items-center gap-1.5 text-xs text-neutral-500 hover:text-blue-400 transition-colors",children:[(0,a.jsx)(n,{size:15}),(0,a.jsx)("span",{children:e.repliesCount})]}),(0,a.jsxs)("button",{onClick:()=>{p(e=>!e),s?.(e.id)},className:`flex items-center gap-1.5 text-xs transition-colors ${h?"text-emerald-400":"text-neutral-500 hover:text-emerald-400"}`,children:[(0,a.jsx)(i,{size:15}),(0,a.jsx)("span",{children:e.boostsCount+ +!!h})]}),(0,a.jsxs)("button",{onClick:()=>{m(e=>!e),t?.(e.id)},className:`flex items-center gap-1.5 text-xs transition-colors ${u?"text-rose-400":"text-neutral-500 hover:text-rose-400"}`,children:[(0,a.jsx)(r,{size:15,className:u?"fill-current":""}),(0,a.jsx)("span",{children:e.likesCount+ +!!u})]})]})]})},d=(0,s.default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),x=(0,s.default)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),u=(0,s.default)("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),m=(0,s.default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),h=(0,s.default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var p=e.i(37727),f=e.i(31278);let y=[{value:"public",icon:u,label:"Herkese Açık",color:"text-emerald-400"},{value:"unlisted",icon:h,label:"Listelenmemiş",color:"text-blue-400"},{value:"private",icon:m,label:"Gizli",color:"text-amber-400"}],b=t.default.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:4000",j=({currentUserId:e,onPostSuccess:t})=>{let[s,r]=(0,l.useState)(""),[i,n]=(0,l.useState)("unlisted"),[o,c]=(0,l.useState)([]),[u,m]=(0,l.useState)(!1),[h,j]=(0,l.useState)(null),v=(0,l.useRef)(null),g=500-s.length,N=g<0,k=""===s.trim()&&0===o.length,w=async()=>{if(!k&&!N&&!u){m(!0),j(null);try{let a=await fetch(`${b}/api/mastodon/publish`,{method:"POST",headers:{"Content-Type":"application/json","x-koza-user-id":e||""},body:JSON.stringify({content:s.trim()})});if(!a.ok)throw Error(await a.text());r(""),c([]),t?.()}catch(e){j("Gönderilemedi. Mastodon hesabınız bağlı mı?")}finally{m(!1)}}};return y.find(e=>e.value===i),(0,a.jsxs)("div",{className:"bg-neutral-900 border border-neutral-800 rounded-2xl p-5 mb-6",children:[(0,a.jsx)("textarea",{value:s,onChange:e=>r(e.target.value),placeholder:"Ne düşünüyorsun, koza? ✨",rows:3,className:"w-full bg-transparent text-neutral-200 placeholder-neutral-600 text-sm resize-none outline-none leading-relaxed",disabled:u}),o.length>0&&(0,a.jsx)("div",{className:"flex gap-2 mt-3 flex-wrap",children:o.map((e,t)=>(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("img",{src:URL.createObjectURL(e),alt:"Preview",className:"w-20 h-20 object-cover rounded-xl"}),(0,a.jsx)("button",{onClick:()=>c(e=>e.filter((e,a)=>a!==t)),className:"absolute -top-1.5 -right-1.5 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center",children:(0,a.jsx)(p.X,{size:10})})]},t))}),h&&(0,a.jsx)("p",{className:"text-xs text-red-400 mt-2",children:h}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-4 pt-3 border-t border-neutral-800",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>v.current?.click(),className:"p-2 rounded-lg text-neutral-500 hover:text-primary-400 hover:bg-primary-500/10 transition-colors",title:"Medya Ekle",disabled:u,children:(0,a.jsx)(x,{size:17})}),(0,a.jsx)("input",{ref:v,type:"file",multiple:!0,accept:"image/*,video/mp4",className:"hidden",onChange:e=>{let t=Array.from(e.target.files||[]),a=["image/jpeg","image/png","image/gif","image/webp","video/mp4"],l=t.filter(e=>a.includes(e.type));c(e=>[...e,...l].slice(0,4))}}),(0,a.jsx)("select",{value:i,onChange:e=>n(e.target.value),className:"bg-neutral-800 border border-neutral-700 text-xs text-neutral-400 rounded-lg px-2 py-1.5 outline-none cursor-pointer",children:y.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:`text-xs tabular-nums font-medium ${g<50?"text-amber-400":N?"text-red-400":"text-neutral-600"}`,children:g}),(0,a.jsxs)("button",{onClick:w,disabled:k||N||u,className:"flex items-center gap-2 px-4 py-2 bg-primary-600 hover:bg-primary-700 disabled:opacity-40 disabled:cursor-not-allowed text-white text-xs font-semibold rounded-xl transition-colors",children:[u?(0,a.jsx)(f.Loader2,{size:14,className:"animate-spin"}):(0,a.jsx)(d,{size:14}),(0,a.jsx)("span",{children:"Paylaş"})]})]})]})]})};var v=e.i(45423);let g=(0,s.default)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),N=(0,s.default)("at-sign",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]]),k=t.default.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:4000",w={favourite:{icon:r,color:"text-rose-400",label:"Beğendi"},reblog:{icon:i,color:"text-emerald-400",label:"Paylaştı"},follow:{icon:g,color:"text-blue-400",label:"Takip Etti"},mention:{icon:N,color:"text-primary-400",label:"Bahsetti"}},z=({notif:e})=>{let t=w[e.type]||{icon:v.Bell,color:"text-neutral-400",label:e.type},l=t.icon;return(0,a.jsxs)("div",{className:"flex items-start gap-3 p-3 rounded-xl hover:bg-neutral-800/50 transition-colors",children:[(0,a.jsx)("div",{className:`mt-0.5 ${t.color} shrink-0`,children:(0,a.jsx)(l,{size:15})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("p",{className:"text-sm text-neutral-300",children:[(0,a.jsxs)("span",{className:"font-semibold text-white",children:["@",e.account?.acct||"birileri"]})," ","seni ",t.label.toLowerCase()]}),e.status?.content&&(0,a.jsx)("p",{className:"text-xs text-neutral-500 mt-1 truncate",dangerouslySetInnerHTML:{__html:e.status.content.replace(/<[^>]+>/g,"")}})]}),(0,a.jsx)("span",{className:"text-xs text-neutral-700 shrink-0",children:new Date(e.created_at).toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"})})]})},S=({currentUserId:e})=>{let[t,s]=(0,l.useState)([]),[r,i]=(0,l.useState)(!1),[n,o]=(0,l.useState)(0),[c,d]=(0,l.useState)(!1),x=async()=>{if(e){i(!0);try{let t=await fetch(`${k}/api/notifications`,{headers:{"x-koza-user-id":e}});if(t.ok){let e=await t.json();o(e.synchronized??0)}}catch(e){console.error("Notification fetch error:",e)}finally{i(!1)}}};return(0,l.useEffect)(()=>{x();let e=setInterval(x,6e4);return()=>clearInterval(e)},[e]),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:()=>{d(e=>!e),o(0)},className:"relative p-2 rounded-xl text-neutral-400 hover:text-white hover:bg-neutral-800 transition-colors",children:[(0,a.jsx)(v.Bell,{size:19}),n>0&&(0,a.jsx)("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-primary-500 text-white text-[10px] font-bold rounded-full flex items-center justify-center",children:n>9?"9+":n})]}),c&&(0,a.jsxs)("div",{className:"absolute right-0 top-full mt-2 w-80 bg-neutral-900 border border-neutral-800 rounded-2xl shadow-2xl z-50 overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-neutral-800",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-white",children:"Bildirimler"}),(0,a.jsx)("button",{onClick:x,className:"text-neutral-500 hover:text-white transition-colors",children:r?(0,a.jsx)(f.Loader2,{size:14,className:"animate-spin"}):(0,a.jsx)(v.Bell,{size:14})})]}),(0,a.jsx)("div",{className:"max-h-80 overflow-y-auto divide-y divide-neutral-800/50",children:0===t.length?(0,a.jsxs)("div",{className:"p-6 text-center",children:[(0,a.jsx)(v.Bell,{className:"w-8 h-8 text-neutral-700 mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-xs text-neutral-600",children:"Yeni bildirim yok"})]}):t.map(e=>(0,a.jsx)(z,{notif:e},e.id))})]})]})};var C=e.i(16715);let M=(0,s.default)("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);var T=e.i(83494);let L=t.default.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:4000",$=[{id:"local",label:"Topluluk"},{id:"koza",label:"#koza"},{id:"metamorfoz",label:"#metamorfoz"}];e.s(["default",0,()=>{let[e,t]=(0,l.useState)("local"),[s,r]=(0,l.useState)([]),[i,n]=(0,l.useState)(null),[o,d]=(0,l.useState)(!1),[x,u]=(0,l.useState)(!0),[m,h]=(0,l.useState)(!0),[p,y]=(0,l.useState)(null),b=(0,l.useRef)(null),{user:v}=(0,T.useAuth)(),g=v?.uid||null,N=(0,l.useCallback)(async(t=!1)=>{if(o&&!t)return;d(!0),y(null);let a=t?void 0:i;try{let l;if("local"===e)l=`${L}/api/community/feed?limit=20${a?`&maxId=${a}`:""}`;else{let t=e.replace("#","");l=`${L}/api/community/feed/tag/${t}?limit=20${a?`&maxId=${a}`:""}`}let s=await fetch(l);if(!s.ok)throw Error(`HTTP ${s.status}`);let i=await s.json(),o=i.posts??[];r(e=>t?o:[...e,...o]),n(i.nextCursor??null),h(o.length>=20&&!!i.nextCursor)}catch(e){y("Feed yüklenemedi. Sunucu bağlantısı kontrol edin.")}finally{d(!1),u(!1)}},[e,i,o]);return(0,l.useEffect)(()=>{u(!0),r([]),n(null),h(!0),N(!0)},[e]),(0,l.useEffect)(()=>{if(!m||o||p)return;let e=new IntersectionObserver(e=>{e[0].isIntersecting&&N(!1)},{threshold:.1});return b.current&&e.observe(b.current),()=>e.disconnect()},[m,o,N]),(0,a.jsxs)("div",{className:"flex-1 flex flex-col h-full overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-4 pt-4 pb-0 shrink-0",children:[(0,a.jsx)("div",{className:"flex gap-1 bg-neutral-900 border border-neutral-800 rounded-xl p-1",children:$.map(l=>(0,a.jsx)("button",{onClick:()=>t(l.id),className:`px-4 py-1.5 text-xs font-semibold rounded-lg transition-all ${e===l.id?"bg-primary-600 text-white shadow-lg shadow-primary-500/20":"text-neutral-400 hover:text-white"}`,children:l.label},l.id))}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>N(!0),disabled:o,className:"p-2 rounded-xl text-neutral-500 hover:text-white hover:bg-neutral-800 transition-colors disabled:opacity-30",title:"Yenile",children:(0,a.jsx)(C.RefreshCw,{size:15,className:o?"animate-spin":""})}),(0,a.jsx)(S,{currentUserId:g})]})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto px-4 py-4 space-y-0",children:[(0,a.jsx)(j,{currentUserId:g,onPostSuccess:()=>N(!0)}),x&&(0,a.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(f.Loader2,{className:"w-8 h-8 text-primary-500 animate-spin mx-auto mb-3"}),(0,a.jsx)("p",{className:"text-sm text-neutral-500",children:"Topluluk yükleniyor..."})]})}),p&&!x&&(0,a.jsxs)("div",{className:"bg-red-950/30 border border-red-900/50 rounded-2xl p-6 text-center",children:[(0,a.jsx)("p",{className:"text-sm text-red-400 mb-3",children:p}),(0,a.jsx)("button",{onClick:()=>N(!0),className:"text-xs text-red-300 hover:text-white",children:"Tekrar Dene"})]}),!x&&!p&&0===s.length&&(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[(0,a.jsx)(M,{className:"w-10 h-10 text-neutral-700 mb-4"}),(0,a.jsx)("p",{className:"text-neutral-500 text-sm",children:"Henüz gönderi yok."}),(0,a.jsx)("p",{className:"text-neutral-700 text-xs mt-1",children:"İlk paylaşımı sen yap!"})]}),(0,a.jsx)("div",{className:"space-y-3",children:s.map(e=>(0,a.jsx)(c,{post:e},e.id))}),(0,a.jsxs)("div",{ref:b,className:"h-10 flex items-center justify-center",children:[o&&!x&&(0,a.jsx)(f.Loader2,{className:"w-5 h-5 text-neutral-600 animate-spin"}),!m&&s.length>0&&(0,a.jsx)("p",{className:"text-xs text-neutral-700",children:"Tüm gönderiler yüklendi"})]})]})]})}],49207)}]);