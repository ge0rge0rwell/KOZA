(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,53458,e=>{"use strict";e.s(["ANALYTICS_CONFIG",0,{measurementId:"G-V0PXH3NLY5"},"API_CONFIG",0,{OPENROUTER_API_KEY:"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"}])},25487,e=>{"use strict";var t=e.i(43476),r=e.i(71645);let s=(0,r.createContext)(null);e.s(["UIProvider",0,({children:e})=>{let[a,l]=(0,r.useState)(null),[o,i]=(0,r.useState)("create"),[n,u]=(0,r.useState)(null),[c,d]=(0,r.useState)([]),[m,S]=(0,r.useState)(!1);(0,r.useEffect)(()=>{localStorage.getItem("koza-onboarding-complete")||S(!0)},[]);let f=(0,r.useCallback)((e,t,r)=>{let s=Date.now();d(a=>[...a,{id:s,type:e,title:t,message:r}]),setTimeout(()=>{d(e=>e.filter(e=>e.id!==s))},3e3)},[]),y=(0,r.useCallback)((e,t,r)=>{u({type:e,title:t,message:r}),setTimeout(()=>u(null),3e3)},[]);return(0,t.jsx)(s.Provider,{value:{currentView:a,setCurrentView:l,activeTab:o,setActiveTab:i,notification:n,setNotification:u,triggerNotification:y,toasts:c,setToasts:d,addToast:f,showOnboarding:m,setShowOnboarding:S},children:e})},"useUI",0,()=>{let e=(0,r.useContext)(s);if(!e)throw Error("useUI must be used within UIProvider");return e}])},4839,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(64961),a=e.i(83494),l=e.i(60880),o=e.i(73767),i=e.i(34354),n=e.i(87315),u=e.i(95713);let c=(0,r.createContext)(null),d=[];e.s(["StoryProvider",0,({children:m})=>{let{user:S,firestoreEnabled:f}=(0,a.useAuth)(),{cloudSynced:y}=(0,l.useUser)(),h=(0,n.useStoryActor)(),p=(0,u.useSelector)(h,e=>e.context.stories),[E,x]=(0,r.useState)(""),[T,C]=(0,r.useState)(!1),[g,v]=(0,r.useState)(null),[b,w]=(0,r.useState)(null),[R,A]=(0,s.default)("koza-stories",[]);(0,r.useEffect)(()=>{R&&R.length>0&&h.send({type:"STORY.FETCH_SUCCESS",stories:R})},[]),(0,r.useEffect)(()=>{A(p)},[p,A]),(0,r.useEffect)(()=>{if(!S||!f||!y)return;h.send({type:"STORY.FETCH_START"}),(async()=>{try{let e=await o.getUserStories(S.uid);if(e){let t=new Map;p.forEach(e=>t.set(String(e.id),e)),e.forEach(e=>t.set(String(e.id),e));let r=Array.from(t.values()).sort((e,t)=>new Date(t.createdAt||0)-new Date(e.createdAt||0)).slice(0,50);h.send({type:"STORY.FETCH_SUCCESS",stories:r})}else h.send({type:"STORY.FETCH_SUCCESS",stories:p})}catch(e){console.error("Story load error:",e),h.send({type:"STORY.FETCH_FAILURE",error:e.message})}})();let e=o.subscribeToStories(S.uid,e=>{e&&h.send({type:"STORY.FETCH_SUCCESS",stories:e})});return()=>e()},[S,f,y,h]);let I=(0,r.useCallback)(async e=>{let t={id:String(Date.now()),...e,createdAt:new Date().toISOString()};h.send({type:"STORY.CREATE_START"}),h.send({type:"STORY.CREATE_SUCCESS",story:t}),w(t);let r="story"===e.type?"story_created":"game_created";if(i.analytics.track(r,{title:e.title}),S&&f)try{await o.saveStory(S.uid,t)}catch(e){console.error("Save story failed",e),h.send({type:"STORY.CREATE_FAILURE",error:e.message})}},[S,f,h]),U=(0,r.useCallback)(async e=>{let t=String(e);if(h.send({type:"STORY.DELETE",id:t}),S&&f)try{await o.deleteStory(S.uid,t)}catch(e){console.error("Delete story failed",e),h.send({type:"STORY.FETCH_START"})}},[S,f,h]),j=(0,r.useCallback)(async(t,r)=>{h.send({type:"STORY.REFINE_START"}),C(!0);try{let{NarrativeDomain:s}=await e.A(74877),a=await s.processRefinementRequest(t,r);if(a.isSafetyTriggered)return h.send({type:"STORY.REFINE_FAILURE",error:a.message}),{success:!1,message:a.message};let l=a.data;return h.send({type:"STORY.REFINE_SUCCESS",story:l}),i.analytics.track("story_refined",{title:l.title}),S&&f&&await o.saveStory(S.uid,l),{success:!0,story:l}}catch(e){return console.error("Refinement failed:",e),h.send({type:"STORY.REFINE_FAILURE",error:e.message}),{success:!1,message:e.message}}finally{C(!1)}},[S,f,h]),O=r.default.useMemo(()=>({savedStories:p,activeStory:E,setActiveStory:x,isProcessing:T,setIsProcessing:C,analysisResult:g,setAnalysisResult:v,lastSavedStory:b,setLastSavedStory:w,communityWorks:d,saveStory:I,deleteStory:U,refineStory:j}),[p,E,T,g,b,I,U,j]);return(0,t.jsx)(c.Provider,{value:O,children:m})},"useStory",0,()=>{let e=(0,r.useContext)(c);if(!e)throw Error("useStory must be used within StoryProvider");return e}])},78894,e=>{"use strict";let t=(0,e.i(75254).default)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);e.s(["AlertTriangle",()=>t],78894)},83518,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(60880),a=e.i(4839),l=e.i(25487);let o=({children:e})=>{let{lastUserEvent:t,setLastUserEvent:o,setUser:i}=(0,s.useUser)(),{lastSavedStory:n,setLastSavedStory:u}=(0,a.useStory)(),{triggerNotification:c,addToast:d}=(0,l.useUI)();return(0,r.useEffect)(()=>{n&&(i(e=>({...e,storiesCreated:"story"===n.type?e.storiesCreated+1:e.storiesCreated,gamesCreated:"game"===n.type?e.gamesCreated+1:e.gamesCreated})),u(null))},[n,i,u]),(0,r.useEffect)(()=>{t&&("levelup"===t.type?c("levelup","Seviye Atladın!",`Yeni seviye: ${t.level}`):"xp"===t.type?c("xp",`+${t.amount} XP`,t.reason):"achievement"===t.type&&t.achievements.forEach(e=>{d("success","Başarı Kazanıldı!",`${e.icon} ${e.name}`)}),o(null))},[t,c,d,o]),e};e.s(["AppProvider",0,({children:e})=>(0,t.jsx)(s.UserProvider,{children:(0,t.jsx)(a.StoryProvider,{children:(0,t.jsx)(l.UIProvider,{children:(0,t.jsx)(o,{children:e})})})}),"useApp",0,()=>{let e=(0,s.useUser)(),t=(0,a.useStory)(),r=(0,l.useUI)();return{...e,...t,...r}}])},87403,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(78894),a=e.i(83494);class l extends r.default.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("ErrorBoundary caught:",e,t),this.setState({errorInfo:t})}render(){return this.state.hasError?(0,t.jsxs)("div",{className:"min-h-screen bg-neutral-50 flex flex-col items-center justify-center px-4",children:[(0,t.jsxs)("div",{className:"max-w-md w-full bg-white rounded-2xl border border-neutral-200 p-8 text-center shadow-sm",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(s.AlertTriangle,{size:32,className:"text-red-600"})}),(0,t.jsx)("h2",{className:"text-2xl font-bold mb-2",children:"Bir Hata Oluştu"}),(0,t.jsx)("p",{className:"text-neutral-600 mb-6",children:"Üzgünüz, beklenmeyen bir sorun oluştu. Lütfen sayfayı yenileyin."}),(0,t.jsx)("button",{onClick:()=>window.location.reload(),className:"px-6 py-3 bg-neutral-900 text-white rounded-full font-medium hover:scale-105 transition-all shadow-lg active:scale-95",children:"Sayfayı Yenile"})]}),(0,t.jsx)(o,{error:this.state.error,errorInfo:this.state.errorInfo})]}):this.props.children}}let o=({error:e,errorInfo:r})=>{try{let{isAdmin:s}=(0,a.useAuth)();if(!s||!e)return null;return(0,t.jsxs)("div",{className:"mt-8 max-w-2xl w-full p-6 bg-red-50 rounded-2xl border border-red-100 text-left overflow-auto animate-fade-in shadow-sm",children:[(0,t.jsx)("p",{className:"font-mono text-sm text-red-700 whitespace-pre-wrap font-bold mb-2 border-b border-red-100 pb-2",children:"Admin View: Error Details"}),(0,t.jsx)("p",{className:"font-mono text-sm text-red-700 whitespace-pre-wrap",children:e.toString()}),r&&(0,t.jsx)("pre",{className:"mt-4 font-mono text-xs text-red-600 whitespace-pre-wrap p-3 bg-white/50 rounded-xl",children:r.componentStack})]})}catch(e){return null}};e.s(["default",0,l])},81809,e=>{e.v(t=>Promise.all(["static/chunks/cca95befd3c1c316.js"].map(t=>e.l(t))).then(()=>t(80411)))},74877,e=>{e.v(t=>Promise.all(["static/chunks/e3d18c8a2f62375b.js"].map(t=>e.l(t))).then(()=>t(80763)))}]);