{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/orwell/KOZA/src/views/ProfileView.jsx"],"sourcesContent":["import React, { useState, useCallback, memo, useMemo } from 'react';\nimport { useUser } from '../context/UserContext';\nimport { useStory } from '../context/StoryContext';\nimport { useUI } from '../context/UIContext';\nimport { useAuth } from '../context/AuthContext';\nimport { X, Trash2, BookOpen, User as UserIcon } from 'lucide-react';\n\n// Memoized Sub-Components\nconst ProfileHeader = memo(({ authUser, userTitle, imgError, onImgError, onClose }) => (\n    <div className=\"flex items-center justify-between mb-8\">\n        <div className=\"flex items-center gap-4\">\n            <div className=\"relative\">\n                {authUser?.photoURL && !imgError ? (\n                    <img\n                        src={authUser.photoURL}\n                        alt={authUser.displayName || 'User'}\n                        className=\"w-16 h-16 rounded-2xl ring-4 ring-white shadow-xl object-cover will-change-transform\"\n                        onError={onImgError}\n                    />\n                ) : (\n                    <div className=\"w-16 h-16 rounded-2xl bg-primary-100 flex items-center justify-center text-primary-600 shadow-xl border-4 border-white\">\n                        <UserIcon size={32} />\n                    </div>\n                )}\n                <div className=\"absolute -bottom-1 -right-1 w-6 h-6 bg-green-500 border-2 border-white rounded-full\" title=\"Online\" />\n            </div>\n            <div>\n                <h1 className=\"text-3xl font-bold tracking-tight text-neutral-900\">\n                    {authUser?.displayName || 'Traveler'}\n                </h1>\n                <p className=\"text-neutral-500 font-medium\">{userTitle || 'Empathy Apprentice'}</p>\n            </div>\n        </div>\n        <button\n            onClick={onClose}\n            className=\"p-3 bg-white/10 hover:bg-white/20 rounded-xl transition-all shadow-sm border border-white/10 cursor-pointer\"\n        >\n            <X size={20} />\n        </button>\n    </div>\n));\n\nconst StatsCard = memo(({ level, xp, nextLevelXp, storiesCreated, savedCount }) => {\n    const progressPercent = useMemo(() => (xp / nextLevelXp) * 100, [xp, nextLevelXp]);\n\n    return (\n        <div className=\"bg-white/10 backdrop-blur-xl rounded-2xl border border-white/10 p-8 mb-6 shadow-sm\">\n            <div className=\"flex items-center justify-between mb-6\">\n                <div>\n                    <div className=\"text-sm text-neutral-600 mb-1 font-bold uppercase tracking-widest text-[10px]\">Level</div>\n                    <div className=\"text-4xl font-black text-neutral-900\">{level}</div>\n                </div>\n                <div className=\"text-right\">\n                    <div className=\"text-sm text-neutral-600 mb-1 font-bold uppercase tracking-widest text-[10px]\">Progress</div>\n                    <div className=\"text-2xl font-extrabold text-primary-600\">\n                        {xp} / {nextLevelXp} <span className=\"text-xs\">XP</span>\n                    </div>\n                </div>\n            </div>\n\n            <div className=\"h-3 bg-neutral-200/30 rounded-full overflow-hidden\">\n                <div\n                    className=\"h-full bg-gradient-to-r from-primary-500 to-primary-600 transition-all duration-1000 ease-out will-change-transform\"\n                    style={{ width: `${progressPercent}%` }}\n                />\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4 mt-6 pt-6 border-t border-white/10\">\n                <div>\n                    <div className=\"text-2xl font-black text-neutral-900 mb-1\">{storiesCreated}</div>\n                    <div className=\"text-[10px] font-bold uppercase tracking-widest text-neutral-500\">Created</div>\n                </div>\n                <div>\n                    <div className=\"text-2xl font-black text-neutral-900 mb-1\">{savedCount}</div>\n                    <div className=\"text-[10px] font-bold uppercase tracking-widest text-neutral-500\">Collection</div>\n                </div>\n            </div>\n        </div>\n    );\n});\n\nconst StoryListItem = memo(({ story, onView, onDelete }) => (\n    <div className=\"bg-white/10 backdrop-blur-xl rounded-xl border border-white/10 p-4 hover:border-white/20 transition-all group hover:bg-white/20\">\n        <div className=\"flex items-start justify-between gap-4\">\n            <button\n                onClick={() => onView(story)}\n                className=\"flex-1 text-left cursor-pointer\"\n            >\n                <h3 className=\"font-bold text-neutral-900 mb-1 group-hover:text-primary-600 transition-colors\">\n                    {story.title}\n                </h3>\n                <p className=\"text-sm text-neutral-600 line-clamp-1 italic font-serif\">\n                    {story.pages?.[0]?.content || story.content}\n                </p>\n                <div className=\"text-[10px] font-bold text-neutral-400 mt-2 uppercase tracking-widest\">\n                    {new Date(story.createdAt).toLocaleDateString('en-US')}\n                </div>\n            </button>\n            <button\n                onClick={() => onDelete(story.id)}\n                className=\"p-2 text-neutral-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors cursor-pointer\"\n            >\n                <Trash2 size={16} />\n            </button>\n        </div>\n    </div>\n));\n\nconst ProfileView = ({ onClose }) => {\n    const { user } = useUser();\n    const { savedStories, deleteStory } = useStory();\n    const { setCurrentView } = useUI();\n    const { user: authUser } = useAuth();\n    const [imgError, setImgError] = useState(false);\n\n    const handleImgError = useCallback(() => setImgError(true), []);\n    const handleViewStory = useCallback((story) => setCurrentView({ type: 'story', data: story }), [setCurrentView]);\n    const handleDeleteStory = useCallback((id) => deleteStory(id), [deleteStory]);\n\n    const renderedStories = useMemo(() => (\n        savedStories.map(story => (\n            <StoryListItem\n                key={story.id}\n                story={story}\n                onView={handleViewStory}\n                onDelete={handleDeleteStory}\n            />\n        ))\n    ), [savedStories, handleViewStory, handleDeleteStory]);\n\n    return (\n        <div className=\"min-h-screen bg-neutral-50/10 backdrop-blur-3xl relative overflow-hidden font-sans\">\n            <div className=\"max-w-4xl mx-auto px-4 py-12 relative z-10\">\n                <ProfileHeader\n                    authUser={authUser}\n                    userTitle={user.title}\n                    imgError={imgError}\n                    onImgError={handleImgError}\n                    onClose={onClose}\n                />\n\n                <StatsCard\n                    level={user.level}\n                    xp={user.xp}\n                    nextLevelXp={user.nextLevelXp}\n                    storiesCreated={user.storiesCreated}\n                    savedCount={savedStories.length}\n                />\n\n                <div className=\"mt-12\">\n                    <h2 className=\"text-sm font-black uppercase tracking-[0.2em] text-neutral-400 mb-6 flex items-center gap-2\">\n                        <BookOpen size={14} />\n                        Story Collection\n                    </h2>\n\n                    {savedStories.length === 0 ? (\n                        <div className=\"bg-white/20 backdrop-blur-xl rounded-2xl border border-white/10 p-16 text-center shadow-sm\">\n                            <BookOpen size={48} className=\"mx-auto mb-6 text-neutral-300 opacity-50\" />\n                            <p className=\"text-neutral-500 mb-8 font-medium italic\">You haven't performed a story metamorphosis yet.</p>\n                            <button\n                                onClick={onClose}\n                                className=\"px-10 py-4 bg-primary-600 text-white rounded-full font-bold hover:bg-primary-700 transition-all shadow-lg hover:shadow-primary-600/20 active:scale-95 cursor-pointer\"\n                            >\n                                Start Adventure\n                            </button>\n                        </div>\n                    ) : (\n                        <div className=\"space-y-4\">\n                            {renderedStories}\n                        </div>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default memo(ProfileView);\n"],"names":[],"mappings":"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"}}]
}