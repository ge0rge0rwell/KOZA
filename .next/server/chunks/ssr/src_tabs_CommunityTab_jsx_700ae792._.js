module.exports=[70180,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(70106);let e=(0,d.default)("heart",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]]),f=(0,d.default)("repeat-2",[["path",{d:"m2 9 3-3 3 3",key:"1ltn5i"}],["path",{d:"M13 18H7a2 2 0 0 1-2-2V6",key:"1r6tfw"}],["path",{d:"m22 15-3 3-3-3",key:"4rnwn2"}],["path",{d:"M11 6h6a2 2 0 0 1 2 2v10",key:"2f72bc"}]]),g=(0,d.default)("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]]),h=(0,d.default)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]),i=({post:a,onLike:d,onBoost:i,onReply:j})=>{var k;let l,[m,n]=(0,c.useState)(!1),[o,p]=(0,c.useState)(!1);return(0,b.jsxs)("article",{className:"bg-neutral-900 border border-neutral-800 rounded-2xl p-5 hover:border-neutral-700 transition-all duration-200 group",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("img",{src:a.author.avatarUrl,alt:a.author.displayName,className:"w-10 h-10 rounded-full object-cover ring-2 ring-neutral-800 group-hover:ring-primary-500/30 transition-all",onError:b=>b.target.src=`https://ui-avatars.com/api/?name=${a.author.username}&background=6d28d9&color=fff`}),(0,b.jsx)("div",{className:"absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-emerald-500 rounded-full border-2 border-neutral-900"})]}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-white truncate",children:a.author.displayName}),(0,b.jsxs)("p",{className:"text-xs text-neutral-500 truncate",children:["@",a.author.username]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-xs text-neutral-600",children:(k=a.createdAt,(l=(Date.now()-new Date(k).getTime())/1e3)<60?`${Math.floor(l)}s`:l<3600?`${Math.floor(l/60)}m`:l<86400?`${Math.floor(l/3600)}s`:new Date(k).toLocaleDateString("tr-TR"))}),(0,b.jsx)("a",{href:a.author.mastodonUrl,target:"_blank",rel:"noopener noreferrer",className:"text-neutral-700 hover:text-primary-400 transition-colors",children:(0,b.jsx)(h,{size:13})})]})]}),(0,b.jsx)("div",{className:"text-neutral-200 text-sm leading-relaxed mb-4 prose prose-invert prose-sm max-w-none",dangerouslySetInnerHTML:{__html:a.htmlContent}}),a.media?.length>0&&(0,b.jsx)("div",{className:`grid gap-2 mb-4 ${a.media.length>1?"grid-cols-2":"grid-cols-1"}`,children:a.media.map((a,c)=>"image"===a.type&&(0,b.jsx)("img",{src:a.url,alt:a.alt||"Media attachment",className:"w-full rounded-xl object-cover max-h-64"},c))}),(0,b.jsxs)("div",{className:"flex items-center gap-6 pt-3 border-t border-neutral-800/50",children:[(0,b.jsxs)("button",{onClick:()=>j?.(a.id),className:"flex items-center gap-1.5 text-xs text-neutral-500 hover:text-blue-400 transition-colors",children:[(0,b.jsx)(g,{size:15}),(0,b.jsx)("span",{children:a.repliesCount})]}),(0,b.jsxs)("button",{onClick:()=>{p(a=>!a),i?.(a.id)},className:`flex items-center gap-1.5 text-xs transition-colors ${o?"text-emerald-400":"text-neutral-500 hover:text-emerald-400"}`,children:[(0,b.jsx)(f,{size:15}),(0,b.jsx)("span",{children:a.boostsCount+ +!!o})]}),(0,b.jsxs)("button",{onClick:()=>{n(a=>!a),d?.(a.id)},className:`flex items-center gap-1.5 text-xs transition-colors ${m?"text-rose-400":"text-neutral-500 hover:text-rose-400"}`,children:[(0,b.jsx)(e,{size:15,className:m?"fill-current":""}),(0,b.jsx)("span",{children:a.likesCount+ +!!m})]})]})]})},j=(0,d.default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),k=(0,d.default)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),l=(0,d.default)("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),m=(0,d.default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),n=(0,d.default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var o=a.i(33508),p=a.i(96221);let q=[{value:"public",icon:l,label:"Herkese Açık",color:"text-emerald-400"},{value:"unlisted",icon:n,label:"Listelenmemiş",color:"text-blue-400"},{value:"private",icon:m,label:"Gizli",color:"text-amber-400"}],r=process.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:4000",s=({currentUserId:a,onPostSuccess:d})=>{let[e,f]=(0,c.useState)(""),[g,h]=(0,c.useState)("unlisted"),[i,l]=(0,c.useState)([]),[m,n]=(0,c.useState)(!1),[s,t]=(0,c.useState)(null),u=(0,c.useRef)(null),v=500-e.length,w=v<0,x=""===e.trim()&&0===i.length,y=async()=>{if(!x&&!w&&!m){n(!0),t(null);try{let b=await fetch(`${r}/api/mastodon/publish`,{method:"POST",headers:{"Content-Type":"application/json","x-koza-user-id":a||""},body:JSON.stringify({content:e.trim()})});if(!b.ok)throw Error(await b.text());f(""),l([]),d?.()}catch(a){t("Gönderilemedi. Mastodon hesabınız bağlı mı?")}finally{n(!1)}}};return q.find(a=>a.value===g),(0,b.jsxs)("div",{className:"bg-neutral-900 border border-neutral-800 rounded-2xl p-5 mb-6",children:[(0,b.jsx)("textarea",{value:e,onChange:a=>f(a.target.value),placeholder:"Ne düşünüyorsun, koza? ✨",rows:3,className:"w-full bg-transparent text-neutral-200 placeholder-neutral-600 text-sm resize-none outline-none leading-relaxed",disabled:m}),i.length>0&&(0,b.jsx)("div",{className:"flex gap-2 mt-3 flex-wrap",children:i.map((a,c)=>(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("img",{src:URL.createObjectURL(a),alt:"Preview",className:"w-20 h-20 object-cover rounded-xl"}),(0,b.jsx)("button",{onClick:()=>l(a=>a.filter((a,b)=>b!==c)),className:"absolute -top-1.5 -right-1.5 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center",children:(0,b.jsx)(o.X,{size:10})})]},c))}),s&&(0,b.jsx)("p",{className:"text-xs text-red-400 mt-2",children:s}),(0,b.jsxs)("div",{className:"flex items-center justify-between mt-4 pt-3 border-t border-neutral-800",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>u.current?.click(),className:"p-2 rounded-lg text-neutral-500 hover:text-primary-400 hover:bg-primary-500/10 transition-colors",title:"Medya Ekle",disabled:m,children:(0,b.jsx)(k,{size:17})}),(0,b.jsx)("input",{ref:u,type:"file",multiple:!0,accept:"image/*,video/mp4",className:"hidden",onChange:a=>{let b=Array.from(a.target.files||[]),c=["image/jpeg","image/png","image/gif","image/webp","video/mp4"],d=b.filter(a=>c.includes(a.type));l(a=>[...a,...d].slice(0,4))}}),(0,b.jsx)("select",{value:g,onChange:a=>h(a.target.value),className:"bg-neutral-800 border border-neutral-700 text-xs text-neutral-400 rounded-lg px-2 py-1.5 outline-none cursor-pointer",children:q.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("span",{className:`text-xs tabular-nums font-medium ${v<50?"text-amber-400":w?"text-red-400":"text-neutral-600"}`,children:v}),(0,b.jsxs)("button",{onClick:y,disabled:x||w||m,className:"flex items-center gap-2 px-4 py-2 bg-primary-600 hover:bg-primary-700 disabled:opacity-40 disabled:cursor-not-allowed text-white text-xs font-semibold rounded-xl transition-colors",children:[m?(0,b.jsx)(p.Loader2,{size:14,className:"animate-spin"}):(0,b.jsx)(j,{size:14}),(0,b.jsx)("span",{children:"Paylaş"})]})]})]})]})};var t=a.i(23312);let u=(0,d.default)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),v=(0,d.default)("at-sign",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]]),w=process.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:4000",x={favourite:{icon:e,color:"text-rose-400",label:"Beğendi"},reblog:{icon:f,color:"text-emerald-400",label:"Paylaştı"},follow:{icon:u,color:"text-blue-400",label:"Takip Etti"},mention:{icon:v,color:"text-primary-400",label:"Bahsetti"}},y=({notif:a})=>{let c=x[a.type]||{icon:t.Bell,color:"text-neutral-400",label:a.type},d=c.icon;return(0,b.jsxs)("div",{className:"flex items-start gap-3 p-3 rounded-xl hover:bg-neutral-800/50 transition-colors",children:[(0,b.jsx)("div",{className:`mt-0.5 ${c.color} shrink-0`,children:(0,b.jsx)(d,{size:15})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("p",{className:"text-sm text-neutral-300",children:[(0,b.jsxs)("span",{className:"font-semibold text-white",children:["@",a.account?.acct||"birileri"]})," ","seni ",c.label.toLowerCase()]}),a.status?.content&&(0,b.jsx)("p",{className:"text-xs text-neutral-500 mt-1 truncate",dangerouslySetInnerHTML:{__html:a.status.content.replace(/<[^>]+>/g,"")}})]}),(0,b.jsx)("span",{className:"text-xs text-neutral-700 shrink-0",children:new Date(a.created_at).toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"})})]})},z=({currentUserId:a})=>{let[d,e]=(0,c.useState)([]),[f,g]=(0,c.useState)(!1),[h,i]=(0,c.useState)(0),[j,k]=(0,c.useState)(!1),l=async()=>{if(a){g(!0);try{let b=await fetch(`${w}/api/notifications`,{headers:{"x-koza-user-id":a}});if(b.ok){let a=await b.json();i(a.synchronized??0)}}catch(a){console.error("Notification fetch error:",a)}finally{g(!1)}}};return(0,c.useEffect)(()=>{l();let a=setInterval(l,6e4);return()=>clearInterval(a)},[a]),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsxs)("button",{onClick:()=>{k(a=>!a),i(0)},className:"relative p-2 rounded-xl text-neutral-400 hover:text-white hover:bg-neutral-800 transition-colors",children:[(0,b.jsx)(t.Bell,{size:19}),h>0&&(0,b.jsx)("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-primary-500 text-white text-[10px] font-bold rounded-full flex items-center justify-center",children:h>9?"9+":h})]}),j&&(0,b.jsxs)("div",{className:"absolute right-0 top-full mt-2 w-80 bg-neutral-900 border border-neutral-800 rounded-2xl shadow-2xl z-50 overflow-hidden",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-neutral-800",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-white",children:"Bildirimler"}),(0,b.jsx)("button",{onClick:l,className:"text-neutral-500 hover:text-white transition-colors",children:f?(0,b.jsx)(p.Loader2,{size:14,className:"animate-spin"}):(0,b.jsx)(t.Bell,{size:14})})]}),(0,b.jsx)("div",{className:"max-h-80 overflow-y-auto divide-y divide-neutral-800/50",children:0===d.length?(0,b.jsxs)("div",{className:"p-6 text-center",children:[(0,b.jsx)(t.Bell,{className:"w-8 h-8 text-neutral-700 mx-auto mb-2"}),(0,b.jsx)("p",{className:"text-xs text-neutral-600",children:"Yeni bildirim yok"})]}):d.map(a=>(0,b.jsx)(y,{notif:a},a.id))})]})]})};var A=a.i(69520);let B=(0,d.default)("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);var C=a.i(29338);let D=process.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:4000",E=[{id:"local",label:"Topluluk"},{id:"koza",label:"#koza"},{id:"metamorfoz",label:"#metamorfoz"}];a.s(["default",0,()=>{let[a,d]=(0,c.useState)("local"),[e,f]=(0,c.useState)([]),[g,h]=(0,c.useState)(null),[j,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)(!0),[n,o]=(0,c.useState)(!0),[q,r]=(0,c.useState)(null),t=(0,c.useRef)(null),{user:u}=(0,C.useAuth)(),v=u?.uid||null,w=(0,c.useCallback)(async(b=!1)=>{if(j&&!b)return;k(!0),r(null);let c=b?void 0:g;try{let d;if("local"===a)d=`${D}/api/community/feed?limit=20${c?`&maxId=${c}`:""}`;else{let b=a.replace("#","");d=`${D}/api/community/feed/tag/${b}?limit=20${c?`&maxId=${c}`:""}`}let e=await fetch(d);if(!e.ok)throw Error(`HTTP ${e.status}`);let g=await e.json(),i=g.posts??[];f(a=>b?i:[...a,...i]),h(g.nextCursor??null),o(i.length>=20&&!!g.nextCursor)}catch(a){r("Feed yüklenemedi. Sunucu bağlantısı kontrol edin.")}finally{k(!1),m(!1)}},[a,g,j]);return(0,c.useEffect)(()=>{m(!0),f([]),h(null),o(!0),w(!0)},[a]),(0,c.useEffect)(()=>{if(!n||j||q)return;let a=new IntersectionObserver(a=>{a[0].isIntersecting&&w(!1)},{threshold:.1});return t.current&&a.observe(t.current),()=>a.disconnect()},[n,j,w]),(0,b.jsxs)("div",{className:"flex-1 flex flex-col h-full overflow-hidden",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between px-4 pt-4 pb-0 shrink-0",children:[(0,b.jsx)("div",{className:"flex gap-1 bg-neutral-900 border border-neutral-800 rounded-xl p-1",children:E.map(c=>(0,b.jsx)("button",{onClick:()=>d(c.id),className:`px-4 py-1.5 text-xs font-semibold rounded-lg transition-all ${a===c.id?"bg-primary-600 text-white shadow-lg shadow-primary-500/20":"text-neutral-400 hover:text-white"}`,children:c.label},c.id))}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>w(!0),disabled:j,className:"p-2 rounded-xl text-neutral-500 hover:text-white hover:bg-neutral-800 transition-colors disabled:opacity-30",title:"Yenile",children:(0,b.jsx)(A.RefreshCw,{size:15,className:j?"animate-spin":""})}),(0,b.jsx)(z,{currentUserId:v})]})]}),(0,b.jsxs)("div",{className:"flex-1 overflow-y-auto px-4 py-4 space-y-0",children:[(0,b.jsx)(s,{currentUserId:v,onPostSuccess:()=>w(!0)}),l&&(0,b.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(p.Loader2,{className:"w-8 h-8 text-primary-500 animate-spin mx-auto mb-3"}),(0,b.jsx)("p",{className:"text-sm text-neutral-500",children:"Topluluk yükleniyor..."})]})}),q&&!l&&(0,b.jsxs)("div",{className:"bg-red-950/30 border border-red-900/50 rounded-2xl p-6 text-center",children:[(0,b.jsx)("p",{className:"text-sm text-red-400 mb-3",children:q}),(0,b.jsx)("button",{onClick:()=>w(!0),className:"text-xs text-red-300 hover:text-white",children:"Tekrar Dene"})]}),!l&&!q&&0===e.length&&(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[(0,b.jsx)(B,{className:"w-10 h-10 text-neutral-700 mb-4"}),(0,b.jsx)("p",{className:"text-neutral-500 text-sm",children:"Henüz gönderi yok."}),(0,b.jsx)("p",{className:"text-neutral-700 text-xs mt-1",children:"İlk paylaşımı sen yap!"})]}),(0,b.jsx)("div",{className:"space-y-3",children:e.map(a=>(0,b.jsx)(i,{post:a},a.id))}),(0,b.jsxs)("div",{ref:t,className:"h-10 flex items-center justify-center",children:[j&&!l&&(0,b.jsx)(p.Loader2,{className:"w-5 h-5 text-neutral-600 animate-spin"}),!n&&e.length>0&&(0,b.jsx)("p",{className:"text-xs text-neutral-700",children:"Tüm gönderiler yüklendi"})]})]})]})}],70180)}];

//# sourceMappingURL=src_tabs_CommunityTab_jsx_700ae792._.js.map