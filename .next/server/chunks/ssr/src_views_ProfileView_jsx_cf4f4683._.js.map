{"version":3,"sources":["../../../../src/views/ProfileView.jsx"],"sourcesContent":["import React, { useState, useCallback, memo, useMemo } from 'react';\nimport { useUser } from '../context/UserContext';\nimport { useStory } from '../context/StoryContext';\nimport { useUI } from '../context/UIContext';\nimport { useAuth } from '../context/AuthContext';\nimport { X, Trash2, BookOpen, User as UserIcon } from 'lucide-react';\n\n// Memoized Sub-Components\nconst ProfileHeader = memo(({ authUser, userTitle, imgError, onImgError, onClose }) => (\n    <div className=\"flex items-center justify-between mb-8\">\n        <div className=\"flex items-center gap-4\">\n            <div className=\"relative\">\n                {authUser?.photoURL && !imgError ? (\n                    <img\n                        src={authUser.photoURL}\n                        alt={authUser.displayName || 'User'}\n                        className=\"w-16 h-16 rounded-2xl ring-4 ring-white shadow-xl object-cover will-change-transform\"\n                        onError={onImgError}\n                    />\n                ) : (\n                    <div className=\"w-16 h-16 rounded-2xl bg-primary-100 flex items-center justify-center text-primary-600 shadow-xl border-4 border-white\">\n                        <UserIcon size={32} />\n                    </div>\n                )}\n                <div className=\"absolute -bottom-1 -right-1 w-6 h-6 bg-green-500 border-2 border-white rounded-full\" title=\"Online\" />\n            </div>\n            <div>\n                <h1 className=\"text-3xl font-bold tracking-tight text-neutral-900\">\n                    {authUser?.displayName || 'Traveler'}\n                </h1>\n                <p className=\"text-neutral-500 font-medium\">{userTitle || 'Empathy Apprentice'}</p>\n            </div>\n        </div>\n        <button\n            onClick={onClose}\n            className=\"p-3 bg-white/10 hover:bg-white/20 rounded-xl transition-all shadow-sm border border-white/10 cursor-pointer\"\n        >\n            <X size={20} />\n        </button>\n    </div>\n));\n\nconst StatsCard = memo(({ level, xp, nextLevelXp, storiesCreated, savedCount }) => {\n    const progressPercent = useMemo(() => (xp / nextLevelXp) * 100, [xp, nextLevelXp]);\n\n    return (\n        <div className=\"bg-white/10 backdrop-blur-xl rounded-2xl border border-white/10 p-8 mb-6 shadow-sm\">\n            <div className=\"flex items-center justify-between mb-6\">\n                <div>\n                    <div className=\"text-sm text-neutral-600 mb-1 font-bold uppercase tracking-widest text-[10px]\">Level</div>\n                    <div className=\"text-4xl font-black text-neutral-900\">{level}</div>\n                </div>\n                <div className=\"text-right\">\n                    <div className=\"text-sm text-neutral-600 mb-1 font-bold uppercase tracking-widest text-[10px]\">Progress</div>\n                    <div className=\"text-2xl font-extrabold text-primary-600\">\n                        {xp} / {nextLevelXp} <span className=\"text-xs\">XP</span>\n                    </div>\n                </div>\n            </div>\n\n            <div className=\"h-3 bg-neutral-200/30 rounded-full overflow-hidden\">\n                <div\n                    className=\"h-full bg-gradient-to-r from-primary-500 to-primary-600 transition-all duration-1000 ease-out will-change-transform\"\n                    style={{ width: `${progressPercent}%` }}\n                />\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4 mt-6 pt-6 border-t border-white/10\">\n                <div>\n                    <div className=\"text-2xl font-black text-neutral-900 mb-1\">{storiesCreated}</div>\n                    <div className=\"text-[10px] font-bold uppercase tracking-widest text-neutral-500\">Created</div>\n                </div>\n                <div>\n                    <div className=\"text-2xl font-black text-neutral-900 mb-1\">{savedCount}</div>\n                    <div className=\"text-[10px] font-bold uppercase tracking-widest text-neutral-500\">Collection</div>\n                </div>\n            </div>\n        </div>\n    );\n});\n\nconst StoryListItem = memo(({ story, onView, onDelete }) => (\n    <div className=\"bg-white/10 backdrop-blur-xl rounded-xl border border-white/10 p-4 hover:border-white/20 transition-all group hover:bg-white/20\">\n        <div className=\"flex items-start justify-between gap-4\">\n            <button\n                onClick={() => onView(story)}\n                className=\"flex-1 text-left cursor-pointer\"\n            >\n                <h3 className=\"font-bold text-neutral-900 mb-1 group-hover:text-primary-600 transition-colors\">\n                    {story.title}\n                </h3>\n                <p className=\"text-sm text-neutral-600 line-clamp-1 italic font-serif\">\n                    {story.pages?.[0]?.content || story.content}\n                </p>\n                <div className=\"text-[10px] font-bold text-neutral-400 mt-2 uppercase tracking-widest\">\n                    {new Date(story.createdAt).toLocaleDateString('en-US')}\n                </div>\n            </button>\n            <button\n                onClick={() => onDelete(story.id)}\n                className=\"p-2 text-neutral-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors cursor-pointer\"\n            >\n                <Trash2 size={16} />\n            </button>\n        </div>\n    </div>\n));\n\nconst ProfileView = ({ onClose }) => {\n    const { user } = useUser();\n    const { savedStories, deleteStory } = useStory();\n    const { setCurrentView } = useUI();\n    const { user: authUser } = useAuth();\n    const [imgError, setImgError] = useState(false);\n\n    const handleImgError = useCallback(() => setImgError(true), []);\n    const handleViewStory = useCallback((story) => setCurrentView({ type: 'story', data: story }), [setCurrentView]);\n    const handleDeleteStory = useCallback((id) => deleteStory(id), [deleteStory]);\n\n    const renderedStories = useMemo(() => (\n        savedStories.map(story => (\n            <StoryListItem\n                key={story.id}\n                story={story}\n                onView={handleViewStory}\n                onDelete={handleDeleteStory}\n            />\n        ))\n    ), [savedStories, handleViewStory, handleDeleteStory]);\n\n    return (\n        <div className=\"min-h-screen bg-neutral-50/10 backdrop-blur-3xl relative overflow-hidden font-sans\">\n            <div className=\"max-w-4xl mx-auto px-4 py-12 relative z-10\">\n                <ProfileHeader\n                    authUser={authUser}\n                    userTitle={user.title}\n                    imgError={imgError}\n                    onImgError={handleImgError}\n                    onClose={onClose}\n                />\n\n                <StatsCard\n                    level={user.level}\n                    xp={user.xp}\n                    nextLevelXp={user.nextLevelXp}\n                    storiesCreated={user.storiesCreated}\n                    savedCount={savedStories.length}\n                />\n\n                <div className=\"mt-12\">\n                    <h2 className=\"text-sm font-black uppercase tracking-[0.2em] text-neutral-400 mb-6 flex items-center gap-2\">\n                        <BookOpen size={14} />\n                        Story Collection\n                    </h2>\n\n                    {savedStories.length === 0 ? (\n                        <div className=\"bg-white/20 backdrop-blur-xl rounded-2xl border border-white/10 p-16 text-center shadow-sm\">\n                            <BookOpen size={48} className=\"mx-auto mb-6 text-neutral-300 opacity-50\" />\n                            <p className=\"text-neutral-500 mb-8 font-medium italic\">You haven't performed a story metamorphosis yet.</p>\n                            <button\n                                onClick={onClose}\n                                className=\"px-10 py-4 bg-primary-600 text-white rounded-full font-bold hover:bg-primary-700 transition-all shadow-lg hover:shadow-primary-600/20 active:scale-95 cursor-pointer\"\n                            >\n                                Start Adventure\n                            </button>\n                        </div>\n                    ) : (\n                        <div className=\"space-y-4\">\n                            {renderedStories}\n                        </div>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default memo(ProfileView);\n"],"names":[],"mappings":"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"}