module.exports=[20041,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(70106);let e=(0,d.default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),f=(0,d.default)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);var g=a.i(33508);let h=(0,d.default)("book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]),i=(0,d.default)("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),j=(0,d.default)("rotate-cw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]),k=(0,d.default)("maximize-2",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]]),l=(0,d.default)("printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]),m=(0,d.default)("share-2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),n=(0,d.default)("volume-2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]),o=(0,d.default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),p=(0,d.default)("volume-x",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]),q=(0,d.default)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]);var r=a.i(8406),s=a.i(96221),t=a.i(26489),u=a.i(44422);let v=({value:a,onChange:d,onSend:e,placeholder:f,disabled:g,onFileSelect:h})=>{let i=c.default.useRef(null);return c.default.useEffect(()=>{i.current&&(i.current.style.height="auto",i.current.style.height=i.current.scrollHeight+"px")},[a]),(0,b.jsxs)("div",{className:`messageBox ${g?"opacity-50 cursor-not-allowed":""}`,children:[(0,b.jsxs)("div",{className:"fileUploadWrapper",children:[(0,b.jsxs)("label",{htmlFor:"file",children:[(0,b.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 337 337",children:[(0,b.jsx)("circle",{strokeWidth:"20",stroke:"currentColor",fill:"none",r:"158.5",cy:"168.5",cx:"168.5"}),(0,b.jsx)("path",{strokeLinecap:"round",strokeWidth:"25",stroke:"currentColor",d:"M167.759 79V259"}),(0,b.jsx)("path",{strokeLinecap:"round",strokeWidth:"25",stroke:"currentColor",d:"M79 167.138H259"})]}),(0,b.jsx)("span",{className:"tooltip",children:"Resim Ekle (Yakında)"})]}),(0,b.jsx)("input",{type:"file",id:"file",name:"file",disabled:g,onChange:a=>h&&h(a.target.files[0])})]}),(0,b.jsx)("textarea",{ref:i,required:"",placeholder:f||"Deneyimini buraya yaz...",id:"messageInput",value:a,onChange:a=>d(a.target.value),onKeyDown:b=>{"Enter"===b.key&&!b.shiftKey&&a.trim()&&(b.preventDefault(),e())},disabled:g,rows:1}),(0,b.jsx)("button",{id:"sendButton",onClick:e,disabled:g||!a.trim(),type:"button",children:(0,b.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 664 663",children:[(0,b.jsx)("path",{fill:"none",d:"M646.293 331.888L17.7538 17.6187L155.245 331.888M646.293 331.888L17.753 646.157L155.245 331.888M646.293 331.888L318.735 330.228L155.245 331.888"}),(0,b.jsx)("path",{strokeLinejoin:"round",strokeLinecap:"round",strokeWidth:"33.67",stroke:"currentColor",d:"M646.293 331.888L17.7538 17.6187L155.245 331.888M646.293 331.888L17.753 646.157L155.245 331.888M646.293 331.888L318.735 330.228L155.245 331.888"})]})})]})};var w=a.i(8876);let x=(0,c.memo)(({title:a,currentPage:c,totalPages:d,onPrev:o,onNext:q,onReset:r,onJump:s,onToggleFullscreen:t,onPrint:u,onShare:v,onMastodonShare:w,isMastodonSharing:x,onToggleAudio:y,isSpeaking:z,onClose:A})=>(0,b.jsxs)("header",{className:"h-16 bg-white border-b border-neutral-200 px-6 flex items-center justify-between z-50 shadow-sm shrink-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(h,{size:20,className:"text-neutral-400"}),(0,b.jsx)("h1",{className:"font-bold text-neutral-800 text-sm tracking-tight truncate max-w-[200px]",children:a}),(0,b.jsx)("button",{onClick:r,title:"Back to Start",className:"flex items-center gap-1 ml-4 py-1 px-2 hover:bg-neutral-50 rounded-lg transition-colors cursor-pointer",children:(0,b.jsx)(i,{size:16,className:"text-neutral-400"})}),(0,b.jsx)("button",{onClick:s,title:"Go to End",className:"flex items-center gap-1 py-1 px-2 hover:bg-neutral-50 rounded-lg transition-colors cursor-pointer",children:(0,b.jsx)(j,{size:16,className:"text-neutral-400"})})]}),(0,b.jsxs)("div",{className:"flex items-center gap-6",children:[(0,b.jsx)("button",{onClick:o,disabled:0===c,className:"p-2 hover:bg-neutral-50 rounded-lg disabled:opacity-20 transition-all text-neutral-600",children:(0,b.jsx)(e,{size:20})}),(0,b.jsxs)("div",{className:"text-xs font-bold tracking-widest text-neutral-500 tabular-nums",children:[c+1," / ",d]}),(0,b.jsx)("button",{onClick:q,disabled:c>=d-1,className:"p-2 hover:bg-neutral-50 rounded-lg disabled:opacity-20 transition-all text-neutral-600",children:(0,b.jsx)(f,{size:20})})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1 px-2 border-r border-neutral-200",children:[(0,b.jsx)("button",{onClick:t,title:"Fullscreen",className:"p-2 hover:bg-neutral-50 rounded-lg text-neutral-400 hover:text-neutral-600",children:(0,b.jsx)(k,{size:18})}),(0,b.jsx)("button",{onClick:u,title:"Print",className:"p-2 hover:bg-neutral-50 rounded-lg text-neutral-400 hover:text-neutral-600",children:(0,b.jsx)(l,{size:18})}),(0,b.jsx)("button",{onClick:v,title:"Share",className:"p-2 hover:bg-neutral-50 rounded-lg text-neutral-400 hover:text-neutral-600",children:(0,b.jsx)(m,{size:18})})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1 ml-1",children:[(0,b.jsxs)("button",{onClick:y,className:`flex items-center gap-2 px-4 py-1.5 rounded-full transition-all text-sm font-bold ${z?"bg-primary-500 text-white shadow-lg":"bg-primary-100 text-primary-600 hover:bg-primary-200"}`,children:[z?(0,b.jsx)(p,{size:16}):(0,b.jsx)(n,{size:16}),(0,b.jsx)("span",{children:"Listen"})]}),(0,b.jsx)("button",{onClick:A,className:"p-2 hover:bg-red-50 hover:text-red-500 rounded-lg text-neutral-400 ml-2 transition-colors",children:(0,b.jsx)(g.X,{size:20})})]})]})]})),y=(0,c.memo)(({page:a,pageNumber:c,alignment:d="left",onPageClick:e,author:f})=>(0,b.jsxs)("div",{onClick:e,className:`flex-1 relative overflow-hidden flex flex-col p-8 sm:p-16 lg:p-24 ${"left"===d?"border-r border-neutral-100":""} transition-all duration-500 cursor-pointer hover:bg-neutral-50/50 ${!a?"opacity-50 cursor-default":""}`,children:[(0,b.jsx)("div",{className:"absolute inset-0 paper-texture pointer-events-none"}),(0,b.jsxs)("div",{className:`relative z-10 flex flex-col h-full max-w-2xl mx-auto w-full ${"right"===d?"text-right":"text-left"}`,children:[(0,b.jsx)("div",{className:`text-[10px] sm:text-xs font-black tracking-[0.2em] text-neutral-300 uppercase mb-8 ${"right"===d?"text-right":"text-left"}`,children:f}),a?(0,b.jsxs)("div",{className:`flex-1 flex flex-col justify-start animate-fade-in-${d}`,children:[(0,b.jsx)("h3",{className:`text-xl font-bold mb-6 text-primary-600/60 uppercase tracking-widest text-sm ${"right"===d?"text-right":"text-left"}`,children:a.title}),(0,b.jsx)("div",{className:"prose prose-slate max-w-none",children:(0,b.jsx)("p",{className:`text-neutral-800 leading-relaxed font-serif text-lg sm:text-xl lg:text-3xl selection:bg-primary-100 ${"right"===d?"text-right pl-4":"text-left pr-4"} overflow-y-auto max-h-[60vh] custom-scrollbar`,children:a.content})})]}):(0,b.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center animate-pulse text-neutral-300",children:[(0,b.jsx)(h,{size:64,className:"mb-4 opacity-20"}),(0,b.jsx)("p",{className:"font-serif italic text-lg",children:"Last Page"})]}),(0,b.jsx)("div",{className:`mt-8 text-sm font-bold text-neutral-300 tabular-nums ${"right"===d?"text-right":"text-left"}`,children:c})]})]})),z=(0,c.memo)(({onClose:a})=>(0,b.jsx)("div",{className:"absolute inset-0 z-40 bg-white/60 backdrop-blur-md flex items-center justify-center animate-fade-in",children:(0,b.jsxs)("div",{className:"text-center p-12 bg-white rounded-[48px] shadow-2xl border border-neutral-100 scale-110",children:[(0,b.jsx)("h3",{className:"text-3xl font-bold mb-4 text-primary-600",children:"A Great Journey!"}),(0,b.jsx)("p",{className:"text-neutral-600 mb-8 max-w-xs mx-auto font-medium text-lg",children:"This story has completed its metamorphosis. New stories await you."}),(0,b.jsx)(u.default,{onClick:a,className:"!py-6 !px-16 !text-xl !rounded-full shadow-2xl",icon:o,children:"Finish and Return"})]})})),A=(0,c.memo)(({story:a,onClose:d})=>{let{refineStory:e,isProcessing:f}=(0,w.useStory)(),[h,i]=(0,c.useState)(0),[j,k]=(0,c.useState)(""),[l,m]=(0,c.useState)(!1),[n,p]=(0,c.useState)(null),u=(0,c.useMemo)(()=>a.pages||[],[a.pages]),A=u.length,B=a.themeColor||"#9333EA",C="KOZA TRAVELER",D=u[h],{toggle:E,isSpeaking:F,stop:G}=((a,b="tr-TR")=>{let[d,e]=(0,c.useState)(!1),[f,g]=(0,c.useState)(!1),[h,i]=(0,c.useState)(!1),j=(0,c.useRef)(null);(0,c.useEffect)(()=>{"speechSynthesis"in window&&i(!0)},[]),(0,c.useEffect)(()=>()=>{window.speechSynthesis.cancel()},[]);let k=(0,c.useCallback)(()=>{let a=window.speechSynthesis.getVoices();return a.find(a=>a.lang.startsWith(b))||a[0]},[b]),l=(0,c.useCallback)(()=>{if(!h||!a)return;window.speechSynthesis.cancel();let c=new SpeechSynthesisUtterance(a);c.lang=b,c.voice=k(),c.rate=.9,c.pitch=1,c.onstart=()=>{e(!0),g(!1)},c.onend=()=>{e(!1),g(!1)},c.onerror=a=>{console.error("Speech error",a),e(!1),g(!1)},j.current=c,window.speechSynthesis.speak(c)},[a,b,h,k]),m=(0,c.useCallback)(()=>{window.speechSynthesis.speaking&&(window.speechSynthesis.pause(),g(!0),e(!1))},[]),n=(0,c.useCallback)(()=>{window.speechSynthesis.paused?(window.speechSynthesis.resume(),g(!1),e(!0)):d||f||l()},[l,d,f]),o=(0,c.useCallback)(()=>{window.speechSynthesis.cancel(),e(!1),g(!1)},[]),p=(0,c.useCallback)(()=>{d?m():n()},[d,m,n]);return{speak:l,pause:m,resume:n,stop:o,toggle:p,isSpeaking:d,isPaused:f,supported:h}})(D?.content);(0,c.useEffect)(()=>{G()},[h,G]),(0,c.useEffect)(()=>()=>G(),[G]);let H=(0,c.useCallback)(()=>i(a=>Math.min(a+2,A%2==0?A-2:A-1)),[A]),I=(0,c.useCallback)(()=>i(a=>Math.max(a-2,0)),[]),J=(0,c.useCallback)(()=>{document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen().catch(a=>console.log(a)):document.documentElement.requestFullscreen()},[]),K=(0,c.useCallback)(()=>requestAnimationFrame(()=>window.print()),[]),L=(0,c.useCallback)(async()=>{let b={title:a.title,text:`Read this story I created with KOZA: ${a.title}`,url:window.location.href};try{navigator.share?await navigator.share(b):(await navigator.clipboard.writeText(window.location.href),alert("Link copied to clipboard!"))}catch(a){console.error("Share error:",a)}},[a.title]),[M,N]=(0,c.useState)(!1),O=async()=>{N(!0);try{await new Promise(a=>setTimeout(a,2e3)),alert("Hikaye Mastodon gönderi kuyruğuna eklendi!")}catch(a){console.error("Mastodon paylaşım hatası",a),alert("Paylaşılamadı. Hesabınız bağlı mı?")}finally{N(!1)}},P=async()=>{if(!j.trim())return;p("loading");let b=await e(a,j);b.success?(p("success"),k(""),setTimeout(()=>{p(null),m(!1)},2e3)):(p("error"),alert(b.message||"An error occurred."))};return u.length?(0,b.jsxs)("div",{className:"min-h-screen bg-[#f3f4f6] text-neutral-900 relative overflow-hidden flex flex-col font-sans",children:[(0,b.jsx)("div",{className:"fixed inset-0 pointer-events-none opacity-20",children:(0,b.jsx)(t.default,{color:B,intensity:.3})}),(0,b.jsx)(x,{title:a.title,currentPage:h,totalPages:A,onPrev:I,onNext:H,onReset:()=>i(0),onJump:()=>i(A-1),onToggleFullscreen:J,onPrint:K,onShare:L,onMastodonShare:O,isMastodonSharing:M,onToggleAudio:E,isSpeaking:F,onClose:d}),(0,b.jsxs)("div",{className:"absolute top-20 right-6 z-50 flex flex-col items-end gap-2",children:[(0,b.jsxs)("button",{onClick:()=>m(!l),className:`flex items-center gap-2 px-4 py-2 rounded-full font-bold text-sm transition-all shadow-lg active:scale-95 ${l?"bg-indigo-600 text-white":"bg-white text-indigo-600 hover:bg-neutral-50"}`,children:[(0,b.jsx)(r.Sparkles,{size:16}),(0,b.jsx)("span",{children:"Edit Story"})]}),l&&(0,b.jsxs)("div",{className:"w-80 bg-white p-4 rounded-3xl shadow-2xl border border-indigo-100 animate-fade-in-up mt-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-indigo-600 font-bold text-xs uppercase tracking-wider",children:[(0,b.jsx)(q,{size:14}),(0,b.jsx)("span",{children:"How shall we change it?"})]}),(0,b.jsx)("button",{onClick:()=>m(!1),className:"text-neutral-400 hover:text-neutral-600",children:(0,b.jsx)(g.X,{size:16})})]}),(0,b.jsx)("p",{className:"text-[10px] text-neutral-500 mb-4 leading-relaxed",children:'E.g.: "Add a side character", "Create a more magical atmosphere" or "Change the ending".'}),(0,b.jsx)(v,{value:j,onChange:k,onSend:P,disabled:"loading"===n,placeholder:"Your feedback..."}),"loading"===n&&(0,b.jsxs)("div",{className:"mt-4 flex items-center justify-center gap-2 text-indigo-600 font-bold text-xs animate-pulse",children:[(0,b.jsx)(s.Loader2,{size:16,className:"animate-spin"}),(0,b.jsx)("span",{children:"KOZA is weaving your story again..."})]}),"success"===n&&(0,b.jsxs)("div",{className:"mt-4 flex items-center justify-center gap-2 text-green-600 font-bold text-xs",children:[(0,b.jsx)(o,{size:16}),(0,b.jsx)("span",{children:"Transformation Complete!"})]})]})]}),(0,b.jsx)("main",{className:"flex-1 relative z-10 overflow-hidden",children:(0,b.jsxs)("div",{className:"w-full h-full bg-white book-depth flex relative overflow-hidden group shadow-2xl",children:[(0,b.jsx)("div",{className:"book-spine"}),(0,b.jsx)(y,{page:u[h],pageNumber:h+1,alignment:"left",onPageClick:I,author:C}),(0,b.jsx)(y,{page:u[h+1],pageNumber:h+2,alignment:"right",onPageClick:H,author:C}),h===A-1&&(0,b.jsx)(z,{onClose:d})]})}),(0,b.jsx)("div",{className:"h-1 bg-neutral-200 w-full shrink-0",children:(0,b.jsx)("div",{className:"h-full bg-primary-500 transition-all duration-700 ease-out",style:{width:`${(h+1)/A*100}%`}})})]}):(0,b.jsx)("div",{className:"min-h-screen bg-neutral-50 flex items-center justify-center p-8",children:(0,b.jsxs)("div",{className:"bg-white rounded-2xl border border-neutral-200 p-12 text-center shadow-xl",children:[(0,b.jsx)("p",{className:"text-neutral-600 mb-6 font-medium",children:"Story could not be loaded"}),(0,b.jsx)("button",{onClick:d,className:"text-primary-600 hover:text-primary-700 font-bold",children:"← Go Back"})]})})});a.s(["default",0,A],20041)}];

//# sourceMappingURL=src_views_StoryView_jsx_31f898f1._.js.map